{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Expires" content="-1"/>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Gothic+A1:wght@500&family=Jua&display=swap" rel="stylesheet"> 
    <title>가게 정보</title>

    
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>

    <style>
      body{
        font-family: 'Jua', sans-serif;
        text-align: center;
      }
      .header{
        vertical-align: middle;
      }
        .restaurant_info{
            text-align: center;
            vertical-align: middle;
        }
        .restaurant_info img{
          width: 30%;
          border-radius: 10%;
        }
        .restaurant_image{
          display: inline-block;
        }
        .restaurant_text{
          display: inline-block;
          font-size: 24px;
          vertical-align: middle;
          padding-left: 20px;
        }
        .card-title{
            font-size:50px;
            font-weight: bold;
            padding-top: 20px;
            display: inline-block;
        }
        .reservation{
          display: inline-block;
        }
        h2 {
          font-size:36px;
          font-weight:bold;
        }
        h3 {
          font-size:28px;
          font-weight:bold;
        }
        h4 {
          font-size:24px;
          font-weight:bold;
        }
        .good a, .goodnum, .goodicon {
          margin : 0 auto;
          justify-content: center;
          float: left;
        }
        textarea {
          width: 80%;
          margin: 10px;
        }

        .card-text {
          font-size: 24px;
        }

        #REVIEW {
          font-family: 'Jua', sans-serif;
        }

        button {
          margin:10px;  
        }

        .review_container {
            margin:10px;  
            width: 80%;
            text-align: left;
            font-family: 'Jua', sans-serif;
        }

        .review_section_title h3 {
            margin:10px;  
            text-align: left;
            font-size: 28px;
            font-weight: bold;
            border-bottom: solid 1px gray;
            width :max-content;
        }
        .review_component {
            display: inline-block;
            text-align: left;
            font-size: 18px;
            margin-left: 10px;
            margin-bottom : 10px;
            margin-top: 10px;
        }

        .review_name {
            text-align: left;
            margin-left: 10px;
            font-weight: bold;
            width: 20%;
        }

        .review_rating {
            width: 20%;
            text-align: auto;
        }

        .review_comment {
            margin: 18px;
        }
        a:hover{
          text-decoration: none;
        }
        .menu_name{
          font-size: 28px;
        }
        .menu_price{
          font-size: 24px;
        }
        .restaurant_image img{
          width: 30%;
          border-radius: 20px;
        }
        .btn{
          display: inline-block;
          width:100px;
            height: 50px;
            border-radius: 10px;
            background-color:gray;
            color:white;
            font-size:24px;
            border:none;
            margin-left: 30px;
            margin-bottom: 20px;
        }
        .good{
          display: inline-block;
        }
    </style>
</head>
<body>
  <div class="header"><p class="card-title">{{shop.name}}</p><div class='reservation'>
    <a href="{% url 'reservation' shop.id%}"><input class="btn" type="button" name="reservation" value="예약하기"></a>
</div>  </div>
        <!--즐겨찾기 기능--> 
  <div class="favorite">
           
  <div style="display:flex; font-size: 2rem;" class="good">
    <div class="goodicon" style="flex: 1 1 1; font-size: 1rem;">
      {% if message == "즐겨찾기 취소" %}
        <i class="xi-star xi-2x"></i>
      {% else %}
        <i class="xi-star-o xi-2x"></i>
    {% endif %}
    </div>
    
    <div>
    <a style="color:white; background-color: black;"href="{% url 'favorite' shop.id %}">
        {{message}}
    </a>
    </div>
    <div class="goodnum">
        즐겨찾는 사람 {{shop.like_count}}명
    </div>
  </div> 
  </div>     
    <br>
  <div class='restaurant_info'> 
    
    {% if shop.photo %}
      <img src="{{shop.photo.url}}" alt="" >
    {% endif %}
 
    <div class="restaurant_text">
    평점: 4.4<br>
    전화번호: {{shop.phone_number}}<br>
    주소: {{shop.address}}<br>
    오픈시간: {{shop.open_time}}<br>
    마감시간: {{shop.close_time}}<br>
    정보: {{shop.description}}<br></p>
    </div>
  </div>
<!--
    <div class='menu_n_review_button'>
        <a href="#"><input type="button" name="menu" value="메뉴"></a>
        <a href="#"><input type="button" name="menu" value="리뷰"></a>
    </div>
-->
    <h2>메뉴</h2>
    {% for m in menu %}
    <div class='menu'>
        <div class="menu_name">{{m.name}}</div>
        <div class="menu_price">{{m.price}}</div>
    </div>
    {% endfor %}
    <br><br>
    <div id = "REVIEW">
        <h2>리뷰</h2>
        {% for reservation in reservations %}
          {% if reservation.customer == user %}
            <h3>이용하신 {{shop.name}}에 만족하셨나요?</h3>
            <h4>사장님께 힘이 되는 별점과 리뷰를 작성해주세요!</h4>
            <form action="/register_review/{{shop.id}}" method="POST">
              {% csrf_token %} 
              <div id = "rating">
                  <div id="star" ></div>
                  <div style="padding-top:10px;">
                      <label for="displayStarRating">별점 : </label><span id="displayStarRating" style="padding-left:10px;">0</span>/[평균별점]

                    </div>
              </div>
              <div id = "register_review">
                  <textarea name="review_text" id="review_text" rows="5"></textarea>
                  <br>
                  <button type="submit" name = "review_save" value="{{shop.id}}">리뷰 등록</button> 
              </div>
            </form>
          {% endif %}
        {% endfor %}
        <div class='review_container'>
            <span class='review_section_title'><h3>리뷰 보기</h3></span><br>
            {% for review in reviews %}
                <div class='review_component'>
                    예약자명: <span class='review_name'>{{review.user.profile.name}}&nbsp</span>
                    <span class='review_rating'>별점: {{review.rating}}</span><br>
                    <spaan class='review_comment'>{{review.comment}}</spaan>
                </div>
                <br><br>
            {% endfor %}
        </div>
    </div>

    <br><br>
   
    <script type="text/javascript">
    $(function() {
        $('div#star').raty({
            score: 0
            ,path : "../static/"
            ,width : 200
            ,click: function(score, evt) {
                $("#starRating").val(score);
                $("#displayStarRating").html(score);
            }
        });
    });
    </script>

<script src="/static/js/review_ranking_jquery.js"></script>
</body>
</html>